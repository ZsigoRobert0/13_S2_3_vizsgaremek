CREATE DATABASE StockMasterDb;
GO

USE StockMasterDb;
GO

CREATE TABLE Users (
    Id INT IDENTITY(1,1) PRIMARY KEY,
    Email NVARCHAR(256) NOT NULL UNIQUE,
    PasswordHash NVARCHAR(512) NOT NULL,
    Balance DECIMAL(18,4) NOT NULL DEFAULT 10000,
    KeepLoggedIn BIT NOT NULL DEFAULT 0
);

CREATE TABLE Assets (
    Id INT IDENTITY(1,1) PRIMARY KEY,
    Symbol NVARCHAR(32) NOT NULL,
    Name NVARCHAR(256),
    LastPrice DECIMAL(18,6) NOT NULL,
    LastUpdated DATETIME2
);

CREATE TABLE Positions (
    Id INT IDENTITY(1,1) PRIMARY KEY,
    UserId INT NOT NULL,
    AssetId INT NOT NULL,
    Quantity DECIMAL(18,6) NOT NULL,
    EntryPrice DECIMAL(18,6) NOT NULL,
    OpenedAt DATETIME2 NOT NULL,
    ClosedAt DATETIME2 NULL,
    IsLong BIT NOT NULL
);

CREATE TABLE Trades (
    Id INT IDENTITY(1,1) PRIMARY KEY,
    PositionId INT NOT NULL,
    ExecutedAt DATETIME2 NOT NULL,
    Price DECIMAL(18,6) NOT NULL,
    Quantity DECIMAL(18,6) NOT NULL,
    Side NVARCHAR(10) NOT NULL
);
